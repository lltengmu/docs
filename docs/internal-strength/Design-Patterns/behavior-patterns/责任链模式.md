## 责任链模式

### 责任链模式概述

责任链模式（Chain of Responsibility Pattern）是一种行为设计模式，它允许多个对象有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。

### 核心思想

- 将请求的发送者和接收者解耦
- 多个对象都有机会处理请求
- 请求沿着链传递，直到被处理或到达链尾

### 基本结构

责任链模式通常包含以下几个角色：

- **Handler（处理器接口）**：声明处理请求的方法和设置后继处理器的方法
- **ConcreteHandler（具体处理器）**：处理请求，如果不能处理则转发给后继处理器

代码示例:

```typescript
type Request = { type: string; time: number };
//处理器接口
abstract class Handler {
  protected nextHandler: Handler | undefined = undefined;

  abstract handle(request: Request): boolean | void;

  setNextHandler(handle: Handler) {
    this.nextHandler = handle;
  }
}

//定义具体的处理类
class Leader extends Handler {
  protected nextHandler: Handler | undefined = undefined;
  constructor() {
    super();
  }

  public handle(request: Request): boolean | void {
    if (request.time < 1) {
      console.log("组长批准了");
      return true;
    }

    return this.nextHandler?.handle(request);
  }
}

//定义具体的处理类
class Manager extends Handler {
  protected nextHandler: Handler | undefined = undefined;
  constructor() {
    super();
  }

  public handle(request: Request): boolean | void {
    if (request.time < 30) {
      console.log("经理批准了");
      return true;
    }

    return this.nextHandler?.handle(request);
  }
}

class Boss extends Handler {
  protected nextHandler: Handler | undefined = undefined;
  constructor() {
    super();
  }

  public handle(request: Request): boolean | void {
    if (request.time < 100) {
      console.log("老板批准了");
      return true;
    }

    return this.nextHandler?.handle(request);
  }
}

//创建一个事务
const request = { type: "请假", time: 15 } as Request;

//创建责任链
const leader = new Leader();
const manager = new Manager();
const boss = new Boss();

leader.setNextHandler(manager);
manager.setNextHandler(boss);

if (leader.handle(request)) {
  console.log("事务被批准了");
} else {
  console.log("事务被拒绝了");
}
```

