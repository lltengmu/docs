# JavaScript ç¼–ç¨‹è¯­è¨€

> ğŸ“š æ¥æºï¼š[ç°ä»£ JavaScript æ•™ç¨‹](https://zh.javascript.info/)
>
> åœ¨è¿™å„¿æˆ‘ä»¬å°†ä»å¤´å¼€å§‹å­¦ä¹  JavaScriptï¼Œä¹Ÿä¼šå­¦ä¹  OOP ç­‰ç›¸å…³é«˜çº§æ¦‚å¿µã€‚æœ¬æ•™ç¨‹ä¸“æ³¨äºè¯­è¨€æœ¬èº«ï¼Œé»˜è®¤ä½¿ç”¨æœ€å°ç¯å¢ƒã€‚

---

## ç›®å½•

- [1. ç®€ä»‹](#1-ç®€ä»‹)
- [2. JavaScript åŸºç¡€çŸ¥è¯†](#2-javascript-åŸºç¡€çŸ¥è¯†)
- [3. ä»£ç è´¨é‡](#3-ä»£ç è´¨é‡)
- [4. Objectï¼ˆå¯¹è±¡ï¼‰åŸºç¡€çŸ¥è¯†](#4-objectå¯¹è±¡åŸºç¡€çŸ¥è¯†)
- [5. æ•°æ®ç±»å‹](#5-æ•°æ®ç±»å‹)
- [6. å‡½æ•°è¿›é˜¶å†…å®¹](#6-å‡½æ•°è¿›é˜¶å†…å®¹)
- [7. å¯¹è±¡å±æ€§é…ç½®](#7-å¯¹è±¡å±æ€§é…ç½®)
- [8. åŸå‹ï¼Œç»§æ‰¿](#8-åŸå‹ç»§æ‰¿)
- [9. ç±»](#9-ç±»)
- [10. é”™è¯¯å¤„ç†](#10-é”™è¯¯å¤„ç†)
- [11. Promiseï¼Œasync/await](#11-promiseasyncawait)
- [12. Generatorï¼Œé«˜çº§ iteration](#12-generatoré«˜çº§-iteration)
- [13. æ¨¡å—](#13-æ¨¡å—)
- [14. æ‚é¡¹](#14-æ‚é¡¹)

---

## 1. ç®€ä»‹

### 1.1 JavaScript ç®€ä»‹

JavaScript æœ€åˆè¢«åˆ›å»ºçš„ç›®çš„æ˜¯"ä½¿ç½‘é¡µæ›´ç”ŸåŠ¨"ã€‚è¿™ç§è¯­è¨€å†™å‡ºæ¥çš„ç¨‹åºè¢«ç§°ä¸º **è„šæœ¬**ã€‚å®ƒä»¬å¯ä»¥è¢«ç›´æ¥å†™åœ¨ç½‘é¡µçš„ HTML ä¸­ï¼Œåœ¨é¡µé¢åŠ è½½çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚

**ä¸ºä»€ä¹ˆå« JavaScriptï¼Ÿ**

JavaScript åœ¨åˆšè¯ç”Ÿçš„æ—¶å€™ï¼Œå®ƒçš„åå­—å« "LiveScript"ã€‚ä½†æ˜¯å› ä¸ºå½“æ—¶ Java å¾ˆæµè¡Œï¼Œæ‰€ä»¥å†³å®šå°†ä¸€é—¨æ–°è¯­è¨€å®šä½ä¸º Java çš„"å¼Ÿå¼Ÿ"ä¼šæœ‰åŠ©äºå®ƒçš„æµè¡Œã€‚

**JavaScript å¼•æ“**

- V8 â€”â€” Chromeã€Opera å’Œ Edge ä¸­çš„å¼•æ“
- SpiderMonkey â€”â€” Firefox ä¸­çš„å¼•æ“
- JavaScriptCore/Nitro/SquirrelFish â€”â€” Safari ä¸­çš„å¼•æ“

### 1.2 æ‰‹å†Œä¸è§„èŒƒ

- **ECMA-262 è§„èŒƒ**ï¼šåŒ…å«äº†æœ€æ·±å…¥ã€æœ€è¯¦ç»†ä¸”è§„èŒƒåŒ–çš„ JavaScript ä¿¡æ¯
- **MDN JavaScript å‚è€ƒ**ï¼šå¸¦æœ‰ç¤ºä¾‹çš„ä¸»è¦æ‰‹å†Œ
- **å…¼å®¹æ€§è¡¨**ï¼š[https://caniuse.com](https://caniuse.com) å’Œ [https://kangax.github.io/compat-table](https://kangax.github.io/compat-table)

### 1.3 ä»£ç ç¼–è¾‘å™¨

- **IDEï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰**ï¼šVS Codeã€WebStorm
- **è½»é‡ç¼–è¾‘å™¨**ï¼šSublime Textã€Notepad++ã€Vim

### 1.4 å¼€å‘è€…æ§åˆ¶å°

æµè§ˆå™¨å¼€å‘è€…æ§åˆ¶å°å¿«æ·é”®ï¼š
- **Chrome/Edge/Opera**ï¼š`F12` æˆ– `Ctrl+Shift+J`
- **Firefox**ï¼š`F12` æˆ– `Ctrl+Shift+K`
- **Safari**ï¼š`Cmd+Option+C`

---

## 2. JavaScript åŸºç¡€çŸ¥è¯†

### 2.1 Hello, world!

```html
<!DOCTYPE html>
<html>
<body>
  <script>
    alert('Hello, world!');
  </script>
</body>
</html>
```

å¤–éƒ¨è„šæœ¬ï¼š
```html
<script src="/path/to/script.js"></script>
```

### 2.2 ä»£ç ç»“æ„

**è¯­å¥**ï¼šæ‰§è¡Œè¡Œä¸ºçš„è¯­æ³•ç»“æ„å’Œå‘½ä»¤ã€‚

```javascript
alert('Hello');
alert('World');
```

**åˆ†å·**ï¼šå½“å­˜åœ¨æ¢è¡Œç¬¦æ—¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥çœç•¥åˆ†å·ï¼ˆè‡ªåŠ¨åˆ†å·æ’å…¥ï¼‰ã€‚

**æ³¨é‡Š**ï¼š
```javascript
// å•è¡Œæ³¨é‡Š

/* å¤šè¡Œæ³¨é‡Š
   å¯ä»¥è·¨è¶Šå¤šè¡Œ
*/
```

### 2.3 ç°ä»£æ¨¡å¼ï¼Œ"use strict"

```javascript
"use strict";

// ä»£ç ä»¥ç°ä»£æ¨¡å¼å·¥ä½œ
```

### 2.4 å˜é‡

```javascript
let message = 'Hello!';
const BIRTHDAY = '18.04.1982';
var oldStyle = 'æ—§å¼å£°æ˜'; // ä¸æ¨è
```

**å‘½åè§„åˆ™**ï¼š
- å˜é‡åå¿…é¡»ä»…åŒ…å«å­—æ¯ã€æ•°å­—ã€ç¬¦å· `$` å’Œ `_`
- é¦–å­—ç¬¦å¿…é¡»éæ•°å­—
- åŒºåˆ†å¤§å°å†™
- ä¸èƒ½ä½¿ç”¨ä¿ç•™å­—

### 2.5 æ•°æ®ç±»å‹

JavaScript æœ‰ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼š

| ç±»å‹ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `number` | æ•´æ•°å’Œæµ®ç‚¹æ•° | `let n = 123;` |
| `bigint` | ä»»æ„é•¿åº¦çš„æ•´æ•° | `let big = 1234567890123456789012345678901234567890n;` |
| `string` | å­—ç¬¦ä¸² | `let str = "Hello";` |
| `boolean` | å¸ƒå°”å€¼ | `let isTrue = true;` |
| `null` | ç©ºå€¼ | `let empty = null;` |
| `undefined` | æœªå®šä¹‰ | `let x;` |
| `symbol` | å”¯ä¸€æ ‡è¯†ç¬¦ | `let id = Symbol("id");` |
| `object` | å¤æ‚æ•°æ®ç»“æ„ | `let user = {name: "John"};` |

**typeof è¿ç®—ç¬¦**ï¼š
```javascript
typeof undefined // "undefined"
typeof 0 // "number"
typeof 10n // "bigint"
typeof true // "boolean"
typeof "foo" // "string"
typeof Symbol("id") // "symbol"
typeof Math // "object"
typeof null // "object" (å†å²é—ç•™bug)
typeof alert // "function"
```

### 2.6 äº¤äº’ï¼šalertã€prompt å’Œ confirm

```javascript
// æ˜¾ç¤ºä¿¡æ¯
alert("Hello");

// è·å–ç”¨æˆ·è¾“å…¥
let age = prompt('ä½ å¤šå¤§äº†?', 18);

// ç¡®è®¤å¯¹è¯æ¡†
let isBoss = confirm("ä½ æ˜¯è€æ¿å—ï¼Ÿ");
```

### 2.7 ç±»å‹è½¬æ¢

```javascript
// å­—ç¬¦ä¸²è½¬æ¢
String(123) // "123"

// æ•°å­—è½¬æ¢
Number("123") // 123
Number("abc") // NaN
Number(true) // 1
Number(false) // 0

// å¸ƒå°”è½¬æ¢
Boolean(1) // true
Boolean(0) // false
Boolean("hello") // true
Boolean("") // false
```

### 2.8 åŸºç¡€è¿ç®—ç¬¦ï¼Œæ•°å­¦è¿ç®—

**æ•°å­¦è¿ç®—ç¬¦**ï¼š`+`, `-`, `*`, `/`, `%`ï¼ˆå–ä½™ï¼‰, `**`ï¼ˆå¹‚ï¼‰

**å­—ç¬¦ä¸²è¿æ¥**ï¼š
```javascript
let s = "my" + "string"; // "mystring"
```

**ä¸€å…ƒè¿ç®—ç¬¦ +**ï¼šè½¬æ¢ä¸ºæ•°å­—
```javascript
+true // 1
+"123" // 123
```

**èµ‹å€¼è¿ç®—ç¬¦**ï¼š`=`, `+=`, `-=`, `*=`, `/=`

**è‡ªå¢/è‡ªå‡**ï¼š`++`, `--`

### 2.9 å€¼çš„æ¯”è¾ƒ

```javascript
// æ¯”è¾ƒè¿ç®—ç¬¦
a > b   // å¤§äº
a < b   // å°äº
a >= b  // å¤§äºç­‰äº
a <= b  // å°äºç­‰äº
a == b  // ç­‰äºï¼ˆä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼‰
a === b // ä¸¥æ ¼ç­‰äºï¼ˆä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼‰
a != b  // ä¸ç­‰äº
a !== b // ä¸¥æ ¼ä¸ç­‰äº
```

### 2.10 æ¡ä»¶åˆ†æ”¯ï¼šif å’Œ '?'

```javascript
// if è¯­å¥
if (year == 2024) {
  alert("å¯¹äº†ï¼");
} else if (year > 2024) {
  alert("å¤ªå¤§äº†");
} else {
  alert("å¤ªå°äº†");
}

// ä¸‰å…ƒè¿ç®—ç¬¦
let result = condition ? value1 : value2;
```

### 2.11 é€»è¾‘è¿ç®—ç¬¦

```javascript
// æˆ–è¿ç®—ç¬¦ ||
result = a || b;

// ä¸è¿ç®—ç¬¦ &&
result = a && b;

// éè¿ç®—ç¬¦ !
result = !value;
```

### 2.12 ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ '??'

```javascript
// è¿”å›ç¬¬ä¸€ä¸ªå·²å®šä¹‰çš„å€¼
let user = null;
let guest = "è®¿å®¢";
alert(user ?? guest); // "è®¿å®¢"
```

### 2.13 å¾ªç¯ï¼šwhile å’Œ for

```javascript
// while å¾ªç¯
while (condition) {
  // å¾ªç¯ä½“
}

// do...while å¾ªç¯
do {
  // å¾ªç¯ä½“
} while (condition);

// for å¾ªç¯
for (let i = 0; i < 10; i++) {
  // å¾ªç¯ä½“
}
```

**break å’Œ continue**ï¼š
```javascript
// break - è·³å‡ºå¾ªç¯
// continue - è·³è¿‡å½“å‰è¿­ä»£
```

### 2.14 "switch" è¯­å¥

```javascript
switch(x) {
  case 'value1':
    // ...
    break;
  case 'value2':
    // ...
    break;
  default:
    // ...
}
```

### 2.15 å‡½æ•°

```javascript
// å‡½æ•°å£°æ˜
function showMessage() {
  alert('Hello everyone!');
}

// å¸¦å‚æ•°
function showMessage(from, text) {
  alert(from + ': ' + text);
}

// å¸¦é»˜è®¤å€¼
function showMessage(from, text = "no text given") {
  alert(from + ": " + text);
}

// è¿”å›å€¼
function sum(a, b) {
  return a + b;
}
```

### 2.16 å‡½æ•°è¡¨è¾¾å¼

```javascript
let sayHi = function() {
  alert("Hello");
};
```

### 2.17 ç®­å¤´å‡½æ•°ï¼ŒåŸºç¡€çŸ¥è¯†

```javascript
// ç®­å¤´å‡½æ•°
let sum = (a, b) => a + b;

// å¤šè¡Œç®­å¤´å‡½æ•°
let sum = (a, b) => {
  let result = a + b;
  return result;
};
```

---

## 3. ä»£ç è´¨é‡

### 3.1 åœ¨æµè§ˆå™¨ä¸­è°ƒè¯•

è°ƒè¯•æ­¥éª¤ï¼š
1. æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° Sources/æºä»£ç  é¢æ¿
3. è®¾ç½®æ–­ç‚¹
4. ä½¿ç”¨è°ƒè¯•æ§åˆ¶æŒ‰é’®ï¼šç»§ç»­ã€æ­¥è¿›ã€æ­¥å…¥ã€æ­¥å‡º

### 3.2 ä»£ç é£æ ¼

æ¨èçš„ä»£ç é£æ ¼æŒ‡å—ï¼š
- [Google JavaScript é£æ ¼æŒ‡å—](https://google.github.io/styleguide/jsguide.html)
- [Airbnb JavaScript é£æ ¼æŒ‡å—](https://github.com/airbnb/javascript)
- [StandardJS](https://standardjs.com/)

è‡ªåŠ¨æ£€æŸ¥å·¥å…·ï¼šESLint

### 3.3 æ³¨é‡Š

```javascript
// å¥½çš„æ³¨é‡Šè§£é‡Š"ä¸ºä»€ä¹ˆ"è€Œä¸æ˜¯"æ˜¯ä»€ä¹ˆ"

/**
 * è¿”å› x çš„ n æ¬¡å¹‚
 * @param {number} x åŸºæ•°
 * @param {number} n å¹‚æ¬¡
 * @return {number} x çš„ n æ¬¡å¹‚
 */
function pow(x, n) {
  return x ** n;
}
```

### 3.4 å¿è€…ä»£ç 

**ä¸è¦æ¨¡ä»¿çš„"å"å®è·µ**ï¼š
- ä½¿ç”¨å•å­—æ¯å˜é‡
- ä½¿ç”¨ç¼©å†™
- ä½¿ç”¨æŠ½è±¡çš„å˜é‡å
- é‡ç”¨å˜é‡å
- ç¼–å†™è¿‡é•¿çš„å‡½æ•°

### 3.5 ä½¿ç”¨ Mocha è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•

```javascript
describe("pow", function() {
  it("2 çš„ 3 æ¬¡æ–¹ç­‰äº 8", function() {
    assert.equal(pow(2, 3), 8);
  });

  it("3 çš„ 4 æ¬¡æ–¹ç­‰äº 81", function() {
    assert.equal(pow(3, 4), 81);
  });
});
```

### 3.6 Polyfill å’Œè½¬è¯‘å™¨

- **è½¬è¯‘å™¨ï¼ˆTranspilerï¼‰**ï¼šå¦‚ Babelï¼Œå°†æ–°è¯­æ³•è½¬æ¢ä¸ºæ—§è¯­æ³•
- **Polyfill**ï¼šå¡«è¡¥ç¼ºå¤±çš„æ–°åŠŸèƒ½å®ç°

---

## 4. Objectï¼ˆå¯¹è±¡ï¼‰åŸºç¡€çŸ¥è¯†

### 4.1 å¯¹è±¡

```javascript
// åˆ›å»ºå¯¹è±¡
let user = {
  name: "John",
  age: 30,
  "likes birds": true  // å¤šè¯å±æ€§å
};

// è®¿é—®å±æ€§
alert(user.name);
alert(user["likes birds"]);

// æ·»åŠ /åˆ é™¤å±æ€§
user.isAdmin = true;
delete user.age;

// æ£€æŸ¥å±æ€§æ˜¯å¦å­˜åœ¨
"name" in user // true
```

### 4.2 å¯¹è±¡å¼•ç”¨å’Œå¤åˆ¶

```javascript
// å¯¹è±¡é€šè¿‡å¼•ç”¨å¤åˆ¶
let user = { name: "John" };
let admin = user;
admin.name = "Pete";
alert(user.name); // "Pete"

// æµ…æ‹·è´
let clone = Object.assign({}, user);

// æ·±æ‹·è´
let deepClone = structuredClone(user);
```

### 4.3 åƒåœ¾å›æ”¶

JavaScript ä½¿ç”¨è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼ŒåŸºäº"å¯è¾¾æ€§"æ¦‚å¿µã€‚

### 4.4 å¯¹è±¡æ–¹æ³•ï¼Œ"this"

```javascript
let user = {
  name: "John",
  sayHi() {
    alert(this.name);
  }
};

user.sayHi(); // "John"
```

### 4.5 æ„é€ å™¨å’Œæ“ä½œç¬¦ "new"

```javascript
function User(name) {
  this.name = name;
  this.isAdmin = false;
}

let user = new User("Jack");
```

### 4.6 å¯é€‰é“¾ "?."

```javascript
let user = {};
alert(user?.address?.street); // undefinedï¼ˆä¸ä¼šæŠ¥é”™ï¼‰

// å¯é€‰æ–¹æ³•è°ƒç”¨
user.admin?.(); // å¦‚æœ admin å­˜åœ¨æ‰è°ƒç”¨
```

### 4.7 Symbol ç±»å‹

```javascript
let id = Symbol("id");
let user = {
  name: "John",
  [id]: 123
};
```

### 4.8 å¯¹è±¡ â€”â€” åŸå§‹å€¼è½¬æ¢

å¯¹è±¡åˆ°åŸå§‹å€¼çš„è½¬æ¢è§„åˆ™ï¼š
1. è°ƒç”¨ `obj[Symbol.toPrimitive](hint)` å¦‚æœå­˜åœ¨
2. å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "string"ï¼Œå°è¯• `obj.toString()` æˆ– `obj.valueOf()`
3. å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "number" æˆ– "default"ï¼Œå°è¯• `obj.valueOf()` æˆ– `obj.toString()`

---

## 5. æ•°æ®ç±»å‹

### 5.1 åŸå§‹ç±»å‹çš„æ–¹æ³•

```javascript
let str = "Hello";
alert(str.toUpperCase()); // "HELLO"

let n = 1.23456;
alert(n.toFixed(2)); // "1.23"
```

### 5.2 æ•°å­—ç±»å‹

```javascript
// ä¹¦å†™æ•°å­—çš„æ–¹å¼
let billion = 1_000_000_000;
let billion2 = 1e9;

// è¿›åˆ¶
let hex = 0xff;
let binary = 0b11111111;
let octal = 0o377;

// å¸¸ç”¨æ–¹æ³•
num.toString(base) // è½¬æ¢ä¸ºæŒ‡å®šè¿›åˆ¶çš„å­—ç¬¦ä¸²
Math.floor(num)    // å‘ä¸‹å–æ•´
Math.ceil(num)     // å‘ä¸Šå–æ•´
Math.round(num)    // å››èˆäº”å…¥
Math.trunc(num)    // ç§»é™¤å°æ•°ç‚¹åçš„å†…å®¹
num.toFixed(n)     // ä¿ç•™ n ä½å°æ•°

// ç‰¹æ®Šå€¼
Infinity, -Infinity, NaN
isNaN(value)
isFinite(value)
```

### 5.3 å­—ç¬¦ä¸²

```javascript
let str = "Hello";
let str2 = 'Hello';
let str3 = `Hello ${name}`;

// å¸¸ç”¨æ–¹æ³•
str.length          // é•¿åº¦
str[0]              // ç¬¬ä¸€ä¸ªå­—ç¬¦
str.toUpperCase()   // è½¬å¤§å†™
str.toLowerCase()   // è½¬å°å†™
str.indexOf(substr) // æŸ¥æ‰¾ä½ç½®
str.includes(substr)// æ˜¯å¦åŒ…å«
str.startsWith(s)   // æ˜¯å¦ä»¥ s å¼€å¤´
str.endsWith(s)     // æ˜¯å¦ä»¥ s ç»“å°¾
str.slice(start, end) // æˆªå–
str.substring(start, end) // æˆªå–
str.substr(start, length) // æˆªå–ï¼ˆå·²åºŸå¼ƒï¼‰
str.split(sep)      // åˆ†å‰²
str.trim()          // å»é™¤é¦–å°¾ç©ºç™½
str.repeat(n)       // é‡å¤ n æ¬¡
```

### 5.4 æ•°ç»„

```javascript
let arr = [1, 2, 3];
let arr2 = new Array(1, 2, 3);

// è®¿é—®å…ƒç´ 
arr[0] // 1
arr.at(-1) // 3 (æœ€åä¸€ä¸ªå…ƒç´ )

// å¢åˆ å…ƒç´ 
arr.push(4)      // æœ«å°¾æ·»åŠ 
arr.pop()        // æœ«å°¾åˆ é™¤
arr.shift()      // å¼€å¤´åˆ é™¤
arr.unshift(0)   // å¼€å¤´æ·»åŠ 

// éå†
for (let item of arr) { }
arr.forEach((item, index, array) => { });
```

### 5.5 æ•°ç»„æ–¹æ³•

```javascript
// æ·»åŠ /åˆ é™¤
arr.splice(start, deleteCount, ...items)
arr.slice(start, end)
arr.concat(arr2)

// æœç´¢
arr.indexOf(item)
arr.includes(item)
arr.find(fn)
arr.findIndex(fn)
arr.filter(fn)

// è½¬æ¢
arr.map(fn)
arr.sort(fn)
arr.reverse()
arr.join(sep)

// å½’çº¦
arr.reduce((acc, item) => acc + item, 0)

// æ£€æŸ¥
arr.some(fn)
arr.every(fn)
Array.isArray(arr)
```

### 5.6 Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰

```javascript
// for...of å¯ä»¥éå†å¯è¿­ä»£å¯¹è±¡
for (let char of "test") {
  alert(char);
}

// è‡ªå®šä¹‰å¯è¿­ä»£å¯¹è±¡
let range = {
  from: 1,
  to: 5,
  [Symbol.iterator]() {
    return {
      current: this.from,
      last: this.to,
      next() {
        if (this.current <= this.last) {
          return { done: false, value: this.current++ };
        } else {
          return { done: true };
        }
      }
    };
  }
};
```

### 5.7 Map and Setï¼ˆæ˜ å°„å’Œé›†åˆï¼‰

```javascript
// Map
let map = new Map();
map.set('key', 'value');
map.get('key');
map.has('key');
map.delete('key');
map.size;

// Set
let set = new Set();
set.add(value);
set.has(value);
set.delete(value);
set.size;
```

### 5.8 WeakMap and WeakSet

```javascript
// WeakMap - åªæ¥å—å¯¹è±¡ä½œä¸ºé”®ï¼Œä¸é˜»æ­¢åƒåœ¾å›æ”¶
let weakMap = new WeakMap();
weakMap.set(obj, "data");

// WeakSet - åªå­˜å‚¨å¯¹è±¡ï¼Œä¸é˜»æ­¢åƒåœ¾å›æ”¶
let weakSet = new WeakSet();
weakSet.add(obj);
```

### 5.9 Object.keysï¼Œvaluesï¼Œentries

```javascript
let user = { name: "John", age: 30 };

Object.keys(user)   // ["name", "age"]
Object.values(user) // ["John", 30]
Object.entries(user) // [["name", "John"], ["age", 30]]

Object.fromEntries([["name", "John"], ["age", 30]]) // { name: "John", age: 30 }
```

### 5.10 è§£æ„èµ‹å€¼

```javascript
// æ•°ç»„è§£æ„
let [a, b, c] = [1, 2, 3];
let [first, , third] = [1, 2, 3];
let [a, b, ...rest] = [1, 2, 3, 4, 5];

// å¯¹è±¡è§£æ„
let {name, age} = {name: "John", age: 30};
let {name: n, age: a} = {name: "John", age: 30};
let {name = "Guest"} = {};
```

### 5.11 æ—¥æœŸå’Œæ—¶é—´

```javascript
let now = new Date();
let date = new Date("2024-01-15");
let date2 = new Date(2024, 0, 15, 10, 30);

// è·å–æ—¥æœŸç»„ä»¶
date.getFullYear()
date.getMonth()     // 0-11
date.getDate()      // 1-31
date.getDay()       // 0-6
date.getHours()
date.getMinutes()
date.getSeconds()
date.getTime()      // æ—¶é—´æˆ³

// è®¾ç½®æ—¥æœŸç»„ä»¶
date.setFullYear(year)
date.setMonth(month)
// ...

// æ—¥æœŸè¿ç®—
let diff = date1 - date2; // æ¯«ç§’å·®
Date.now() // å½“å‰æ—¶é—´æˆ³
```

### 5.12 JSON æ–¹æ³•ï¼ŒtoJSON

```javascript
// åºåˆ—åŒ–
let json = JSON.stringify(obj);
let json = JSON.stringify(obj, null, 2); // æ ¼å¼åŒ–

// è§£æ
let obj = JSON.parse(json);

// è‡ªå®šä¹‰ toJSON
let room = {
  number: 23,
  toJSON() {
    return this.number;
  }
};
```

---

## 6. å‡½æ•°è¿›é˜¶å†…å®¹

### 6.1 é€’å½’å’Œå †æ ˆ

```javascript
function pow(x, n) {
  if (n == 1) {
    return x;
  } else {
    return x * pow(x, n - 1);
  }
}
```

### 6.2 Rest å‚æ•°ä¸ Spread è¯­æ³•

```javascript
// Rest å‚æ•°
function sumAll(...args) {
  let sum = 0;
  for (let arg of args) sum += arg;
  return sum;
}

// Spread è¯­æ³•
let arr = [1, 2, 3];
alert(Math.max(...arr));
let merged = [...arr1, ...arr2];
let clone = {...obj};
```

### 6.3 å˜é‡ä½œç”¨åŸŸï¼Œé—­åŒ…

```javascript
// é—­åŒ… - å‡½æ•°è®°ä½å…¶åˆ›å»ºæ—¶çš„è¯æ³•ç¯å¢ƒ
function makeCounter() {
  let count = 0;
  return function() {
    return count++;
  };
}

let counter = makeCounter();
alert(counter()); // 0
alert(counter()); // 1
```

### 6.4 è€æ—§çš„ "var"

```javascript
// var æ²¡æœ‰å—çº§ä½œç”¨åŸŸ
// var å¯ä»¥é‡å¤å£°æ˜
// var å£°æ˜ä¼šè¢«æå‡
// ä¸æ¨èä½¿ç”¨ï¼Œè¯·ä½¿ç”¨ let å’Œ const
```

### 6.5 å…¨å±€å¯¹è±¡

```javascript
// æµè§ˆå™¨ä¸­æ˜¯ window
// Node.js ä¸­æ˜¯ global
// é€šç”¨çš„æ˜¯ globalThis
```

### 6.6 å‡½æ•°å¯¹è±¡ï¼ŒNFE

```javascript
function sayHi() {
  alert("Hi");
}

alert(sayHi.name); // "sayHi"
alert(sayHi.length); // 0 (å‚æ•°ä¸ªæ•°)

// å‘½åå‡½æ•°è¡¨è¾¾å¼ (NFE)
let sayHi = function func(who) {
  if (who) {
    alert(`Hello, ${who}`);
  } else {
    func("Guest"); // å†…éƒ¨è°ƒç”¨è‡ªå·±
  }
};
```

### 6.7 "new Function" è¯­æ³•

```javascript
let func = new Function('a', 'b', 'return a + b');
alert(func(1, 2)); // 3
```

### 6.8 è°ƒåº¦ï¼šsetTimeout å’Œ setInterval

```javascript
// å»¶æ—¶æ‰§è¡Œ
let timerId = setTimeout(func, delay, ...args);
clearTimeout(timerId);

// å‘¨æœŸæ‰§è¡Œ
let intervalId = setInterval(func, delay, ...args);
clearInterval(intervalId);

// åµŒå¥— setTimeout
let timerId = setTimeout(function tick() {
  // ...
  timerId = setTimeout(tick, delay);
}, delay);
```

### 6.9 è£…é¥°å™¨æ¨¡å¼å’Œè½¬å‘ï¼Œcall/apply

```javascript
// call
func.call(context, arg1, arg2);

// apply
func.apply(context, [args]);

// è£…é¥°å™¨ç¤ºä¾‹
function cachingDecorator(func) {
  let cache = new Map();
  return function(x) {
    if (cache.has(x)) {
      return cache.get(x);
    }
    let result = func(x);
    cache.set(x, result);
    return result;
  };
}
```

### 6.10 å‡½æ•°ç»‘å®š

```javascript
let boundFunc = func.bind(context, ...args);

// åå‡½æ•°
function mul(a, b) {
  return a * b;
}
let double = mul.bind(null, 2);
alert(double(5)); // 10
```

### 6.11 æ·±å…¥ç†è§£ç®­å¤´å‡½æ•°

```javascript
// ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this
// ç®­å¤´å‡½æ•°æ²¡æœ‰ arguments
// ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæ„é€ å™¨
// ç®­å¤´å‡½æ•°æ²¡æœ‰ super
```

---

## 7. å¯¹è±¡å±æ€§é…ç½®

### 7.1 å±æ€§æ ‡å¿—å’Œå±æ€§æè¿°ç¬¦

```javascript
// è·å–å±æ€§æè¿°ç¬¦
let descriptor = Object.getOwnPropertyDescriptor(obj, propertyName);
// { value: ..., writable: true, enumerable: true, configurable: true }

// å®šä¹‰å±æ€§
Object.defineProperty(obj, propertyName, descriptor);

// å®šä¹‰å¤šä¸ªå±æ€§
Object.defineProperties(obj, {
  prop1: descriptor1,
  prop2: descriptor2
});
```

### 7.2 å±æ€§çš„ getter å’Œ setter

```javascript
let user = {
  name: "John",
  surname: "Smith",

  get fullName() {
    return `${this.name} ${this.surname}`;
  },

  set fullName(value) {
    [this.name, this.surname] = value.split(" ");
  }
};

alert(user.fullName); // "John Smith"
user.fullName = "Alice Cooper";
```

---

## 8. åŸå‹ï¼Œç»§æ‰¿

### 8.1 åŸå‹ç»§æ‰¿

```javascript
let animal = {
  eats: true,
  walk() {
    alert("Animal walk");
  }
};

let rabbit = {
  jumps: true,
  __proto__: animal
};

// rabbit å¯ä»¥è®¿é—® animal çš„å±æ€§å’Œæ–¹æ³•
alert(rabbit.eats); // true
rabbit.walk(); // "Animal walk"
```

### 8.2 F.prototype

```javascript
function Rabbit(name) {
  this.name = name;
}

Rabbit.prototype = animal;

let rabbit = new Rabbit("White Rabbit");
alert(rabbit.eats); // true
```

### 8.3 åŸç”Ÿçš„åŸå‹

```javascript
// æ‰€æœ‰å¯¹è±¡éƒ½ç»§æ‰¿è‡ª Object.prototype
// æ•°ç»„ç»§æ‰¿è‡ª Array.prototype
// å‡½æ•°ç»§æ‰¿è‡ª Function.prototype
// ç­‰ç­‰...

// ä¿®æ”¹åŸç”ŸåŸå‹ï¼ˆä¸æ¨èï¼‰
String.prototype.show = function() {
  alert(this);
};
"BOOM!".show();
```

### 8.4 åŸå‹æ–¹æ³•ï¼Œæ²¡æœ‰ __proto__ çš„å¯¹è±¡

```javascript
// æ¨èçš„æ–¹æ³•
Object.create(proto, descriptors)
Object.getPrototypeOf(obj)
Object.setPrototypeOf(obj, proto)

// åˆ›å»ºæ— åŸå‹å¯¹è±¡
let obj = Object.create(null);
```

---

## 9. ç±»

### 9.1 Class åŸºæœ¬è¯­æ³•

```javascript
class User {
  constructor(name) {
    this.name = name;
  }

  sayHi() {
    alert(this.name);
  }
}

let user = new User("John");
user.sayHi();
```

### 9.2 ç±»ç»§æ‰¿

```javascript
class Animal {
  constructor(name) {
    this.name = name;
  }

  speak() {
    alert(this.name + ' makes a sound.');
  }
}

class Dog extends Animal {
  constructor(name) {
    super(name);
  }

  speak() {
    alert(this.name + ' barks.');
  }
}
```

### 9.3 é™æ€å±æ€§å’Œé™æ€æ–¹æ³•

```javascript
class Article {
  static publisher = "Ilya Kantor";

  static compare(a, b) {
    return a.date - b.date;
  }
}

alert(Article.publisher);
```

### 9.4 ç§æœ‰çš„å’Œå—ä¿æŠ¤çš„å±æ€§å’Œæ–¹æ³•

```javascript
class CoffeeMachine {
  #waterLimit = 200; // ç§æœ‰å±æ€§

  get waterAmount() {
    return this.#waterLimit;
  }

  #fixWater(value) { // ç§æœ‰æ–¹æ³•
    // ...
  }
}
```

### 9.5 æ‰©å±•å†…å»ºç±»

```javascript
class PowerArray extends Array {
  isEmpty() {
    return this.length === 0;
  }
}

let arr = new PowerArray(1, 2, 5, 10, 50);
alert(arr.isEmpty()); // false
```

### 9.6 ç±»æ£€æŸ¥ï¼š"instanceof"

```javascript
obj instanceof Class // æ£€æŸ¥å¯¹è±¡æ˜¯å¦å±äºæŸä¸ªç±»

// è‡ªå®šä¹‰ instanceof è¡Œä¸º
class Animal {
  static [Symbol.hasInstance](obj) {
    if (obj.canEat) return true;
  }
}
```

### 9.7 Mixin æ¨¡å¼

```javascript
let sayHiMixin = {
  sayHi() {
    alert(`Hello ${this.name}`);
  },
  sayBye() {
    alert(`Bye ${this.name}`);
  }
};

class User {
  constructor(name) {
    this.name = name;
  }
}

Object.assign(User.prototype, sayHiMixin);
```

---

## 10. é”™è¯¯å¤„ç†

### 10.1 é”™è¯¯å¤„ç†ï¼Œ"try...catch"

```javascript
try {
  // å¯èƒ½å‡ºé”™çš„ä»£ç 
  let result = riskyOperation();
} catch (err) {
  // é”™è¯¯å¤„ç†
  alert(err.name);
  alert(err.message);
  alert(err.stack);
} finally {
  // æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œ
  cleanup();
}

// æŠ›å‡ºé”™è¯¯
throw new Error("Something went wrong");
```

### 10.2 è‡ªå®šä¹‰ Errorï¼Œæ‰©å±• Error

```javascript
class ValidationError extends Error {
  constructor(message) {
    super(message);
    this.name = "ValidationError";
  }
}

function test() {
  throw new ValidationError("Whoops!");
}

try {
  test();
} catch(err) {
  alert(err.message);
  alert(err.name);
  alert(err instanceof ValidationError); // true
}
```

---

## 11. Promiseï¼Œasync/await

### 11.1 ç®€ä»‹ï¼šå›è°ƒ

```javascript
// å›è°ƒåœ°ç‹±
loadScript('1.js', function(error, script) {
  loadScript('2.js', function(error, script) {
    loadScript('3.js', function(error, script) {
      // ...
    });
  });
});
```

### 11.2 Promise

```javascript
let promise = new Promise(function(resolve, reject) {
  // å¼‚æ­¥æ“ä½œ
  setTimeout(() => resolve("done!"), 1000);
});

promise.then(
  result => alert(result), // "done!"
  error => alert(error)
);

// ç®€å†™
promise
  .then(result => alert(result))
  .catch(error => alert(error))
  .finally(() => alert("finally"));
```

### 11.3 Promise é“¾

```javascript
fetch('/article/promise-chaining/user.json')
  .then(response => response.json())
  .then(user => fetch(`https://api.github.com/users/${user.name}`))
  .then(response => response.json())
  .then(githubUser => {
    // ...
  });
```

### 11.4 ä½¿ç”¨ promise è¿›è¡Œé”™è¯¯å¤„ç†

```javascript
fetch('/article')
  .then(response => response.json())
  .then(data => { /* ... */ })
  .catch(error => {
    // å¤„ç†é“¾ä¸­ä»»æ„ä½ç½®çš„é”™è¯¯
    alert(error);
  });
```

### 11.5 Promise API

```javascript
Promise.all([promise1, promise2, promise3])
  .then(results => { /* æ‰€æœ‰éƒ½å®Œæˆ */ });

Promise.allSettled([promise1, promise2, promise3])
  .then(results => { /* æ‰€æœ‰éƒ½å·²æ•²å®š */ });

Promise.race([promise1, promise2, promise3])
  .then(result => { /* ç¬¬ä¸€ä¸ªå®Œæˆçš„ */ });

Promise.any([promise1, promise2, promise3])
  .then(result => { /* ç¬¬ä¸€ä¸ªæˆåŠŸçš„ */ });

Promise.resolve(value);
Promise.reject(error);
```

### 11.6 Promisification

```javascript
function promisify(f) {
  return function (...args) {
    return new Promise((resolve, reject) => {
      function callback(err, result) {
        if (err) {
          reject(err);
        } else {
          resolve(result);
        }
      }
      args.push(callback);
      f.call(this, ...args);
    });
  };
}
```

### 11.7 å¾®ä»»åŠ¡ï¼ˆMicrotaskï¼‰

Promise å¤„ç†ç¨‹åºåœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼Œåœ¨å½“å‰ä»£ç æ‰§è¡Œå®Œæ¯•åç«‹å³æ‰§è¡Œã€‚

### 11.8 async/await

```javascript
async function f() {
  let promise = new Promise((resolve, reject) => {
    setTimeout(() => resolve("done!"), 1000);
  });

  let result = await promise; // ç­‰å¾… promise å®Œæˆ
  alert(result);
}

f();

// é”™è¯¯å¤„ç†
async function f() {
  try {
    let response = await fetch('/article');
  } catch(err) {
    alert(err);
  }
}
```

---

## 12. Generatorï¼Œé«˜çº§ iteration

### 12.1 Generator

```javascript
function* generateSequence() {
  yield 1;
  yield 2;
  return 3;
}

let generator = generateSequence();

let one = generator.next(); // {value: 1, done: false}
let two = generator.next(); // {value: 2, done: false}
let three = generator.next(); // {value: 3, done: true}

// generator æ˜¯å¯è¿­ä»£çš„
for (let value of generateSequence()) {
  alert(value); // 1, ç„¶åæ˜¯ 2
}
```

### 12.2 å¼‚æ­¥è¿­ä»£å’Œ generator

```javascript
// å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡
let range = {
  from: 1,
  to: 5,

  async *[Symbol.asyncIterator]() {
    for(let value = this.from; value <= this.to; value++) {
      await new Promise(resolve => setTimeout(resolve, 1000));
      yield value;
    }
  }
};

(async () => {
  for await (let value of range) {
    alert(value); // 1, 2, 3, 4, 5
  }
})();
```

---

## 13. æ¨¡å—

### 13.1 æ¨¡å— (Module) ç®€ä»‹

```html
<script type="module">
  import {sayHi} from './say.js';
  sayHi('John');
</script>
```

æ¨¡å—ç‰¹æ€§ï¼š
- å§‹ç»ˆä½¿ç”¨ "use strict"
- æ¯ä¸ªæ¨¡å—æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ
- æ¨¡å—ä»£ç åªåœ¨é¦–æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œä¸€æ¬¡
- æ¨¡å—ä¸­ `this` æ˜¯ `undefined`

### 13.2 å¯¼å‡ºå’Œå¯¼å…¥

```javascript
// å‘½åå¯¼å‡º
export let name = "John";
export function sayHi() { /* ... */ }
export class User { /* ... */ }

// é»˜è®¤å¯¼å‡º
export default class User { /* ... */ }

// å¯¼å…¥
import {sayHi, sayBye} from './say.js';
import * as say from './say.js';
import User from './user.js';

// é‡å‘½å
import {sayHi as hi} from './say.js';
export {sayHi as hi};

// é‡æ–°å¯¼å‡º
export {sayHi} from './say.js';
export * from './user.js';
```

### 13.3 åŠ¨æ€å¯¼å…¥

```javascript
let module = await import('./say.js');

// æˆ–è€…ä½¿ç”¨ .then
import('./say.js')
  .then(module => {
    module.sayHi();
  });
```

---

## 14. æ‚é¡¹

### 14.1 Proxy å’Œ Reflect

```javascript
let proxy = new Proxy(target, {
  get(target, prop, receiver) {
    return Reflect.get(target, prop, receiver);
  },
  set(target, prop, value, receiver) {
    return Reflect.set(target, prop, value, receiver);
  }
  // ... å…¶ä»–æ•æ‰å™¨
});
```

### 14.2 Evalï¼šæ‰§è¡Œä»£ç å­—ç¬¦ä¸²

```javascript
let result = eval('1 + 2');
alert(result); // 3

// æ³¨æ„ï¼ševal æœ‰å®‰å…¨é£é™©ï¼Œä¸æ¨èä½¿ç”¨
```

### 14.3 æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰

```javascript
function curry(f) {
  return function(a) {
    return function(b) {
      return f(a, b);
    };
  };
}

function sum(a, b) {
  return a + b;
}

let curriedSum = curry(sum);
alert(curriedSum(1)(2)); // 3
```

### 14.4 Reference Type

Reference Type æ˜¯ ECMA è§„èŒƒä¸­çš„ä¸€ä¸ª"è§„èŒƒç±»å‹"ï¼Œç”¨äºè§£é‡Š `this` çš„å·¥ä½œåŸç†ã€‚

### 14.5 BigInt

```javascript
const bigInt = 1234567890123456789012345678901234567890n;

// è¿ç®—
alert(1n + 2n); // 3n
alert(5n / 2n); // 2n (å‘ä¸‹å–æ•´)

// è½¬æ¢
Number(bigInt)
BigInt(number)
```

### 14.6 Unicode â€”â€” å­—ç¬¦ä¸²å†…å¹•

```javascript
// ä»£ç†å¯¹ (surrogate pairs)
alert('ğ’³'.length); // 2
alert('ğ’³'.charCodeAt(0).toString(16)); // d835
alert('ğ’³'.charCodeAt(1).toString(16)); // dcb3

// å˜éŸ³ç¬¦å·
alert('S\u0307'); // á¹ 
alert('S\u0307\u0323'); // á¹¨

// è§„èŒƒåŒ–
alert("S\u0307\u0323".normalize()); // á¹¨
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [ç°ä»£ JavaScript æ•™ç¨‹](https://zh.javascript.info/)
- [MDN Web Docs](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript)
- [ECMAScript è§„èŒƒ](https://tc39.es/ecma262/)

